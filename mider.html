<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animação e AR com MindAR</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script>
        AFRAME.registerComponent('alternar-texturas', {
            schema: {
                src1: {type: 'string'}, // Caminho para a primeira imagem
                src2: {type: 'string'}, // Caminho para a segunda imagem
                src3: {type: 'string'}, // Caminho para a terceira imagem
                src4: {type: 'string'}, // Caminho para a terceira imagem
                intervalo: {type: 'int', default: 300} // Intervalo em milissegundos
            },
            init: function () {
                // Array com as texturas e índice inicial
                this.texturas = [this.data.src1, this.data.src2, this.data.src3, this.data.src4];
                this.indiceAtual = 0;
    
                // Configura a primeira textura
                this.el.setAttribute('material', 'src', this.texturas[this.indiceAtual]);
                this.el.setAttribute('material', 'transparent', true);
    
                // Define o intervalo para alternar as texturas
                this.timer = setInterval(() => {
                    this.alternar();
                }, this.data.intervalo);
            },
            alternar: function () {
                // Atualiza o índice para a próxima textura
                this.indiceAtual = (this.indiceAtual + 1) % this.texturas.length;
    
                // Define a nova textura no material
                this.el.setAttribute('material', 'src', this.texturas[this.indiceAtual]);
            },
            remove: function () {
                // Limpa o intervalo quando o componente é removido
                clearInterval(this.timer);
            }
        });
    </script>
</head>

<body>
    <a-scene
        mindar-image="imageTargetSrc: ./targetsUrso.mind"
        color-space="sRGB"
        renderer="colorManagement: true, physicallyCorrectLights"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false">

        <a-assets>
            <!-- Pré-carregue as imagens para alternar -->
            <img id="imagem1" src="/Urso 1.png" alt="Imagem 1">
            <img id="imagem2" src="/Urso 2.png" alt="Imagem 2">
            <img id="imagem3" src="/Urso 3.png" alt="Imagem 3">
            <img id="imagem4" src="/Urso 4.png" alt="Imagem 4">
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
        <a-light type="ambient" color="#FFFFFF"></a-light>
        
        <!-- Alvo MindAR com alternância de imagens -->
        <a-entity mindar-image-target="targetIndex: 0">
            <a-plane 
                position="0 0 0"
                width="1.5" 
                height="1.5" 
                rotation="0 0 0"
                alternar-texturas="src1: #imagem1; src2: #imagem2; src3: #imagem3; src4: #imagem4; intervalo: 1000">
            </a-plane>
        </a-entity>
    </a-scene>
</body>
</html>